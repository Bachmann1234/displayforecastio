# coding=utf-8
import sys

import os
from mock import patch
from terminalweather.app import FORECAST_DEV_KEY_VAR, main, format_weather, get_weather


def test_no_key(monkeypatch):
    monkeypatch.setattr(sys, 'argv', ['script_name', '4.3', '4'])
    if os.getenv(FORECAST_DEV_KEY_VAR):
        monkeypatch.delenv(FORECAST_DEV_KEY_VAR)
    assert main() == -1


def test_weather_called_correctly(monkeypatch):
    monkeypatch.setattr(sys, 'argv', ['script_name', '4.3', '4'])
    monkeypatch.setenv(FORECAST_DEV_KEY_VAR, "IamaKey")
    with patch('terminalweather.app.get_weather') as get_weather_mock:
        main()
        get_weather_mock.assert_called_with('IamaKey', 4.3, 4)


def test_api_live():
    # This test is live and assumes you have an api key in your environment
    result = get_weather(os.environ[FORECAST_DEV_KEY_VAR], 42.361369, -71.083544)
    assert isinstance(result, dict)
    assert 'daily' in result
    assert 'summary' in result['daily']
    assert 'icon' in result['daily']


def test_format_weather():
    # this is a super long line and is the output of an api call.
    # To make an exception to pep8 I add the #noqa to the end of it
    api_input = {u'hourly': {u'icon': u'partly-cloudy-night', u'data': [{u'ozone': 315.74, u'temperature': 35.89, u'icon': u'clear-night', u'dewPoint': 20.09, u'humidity': 0.52, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 32.79, u'pressure': 1030.62, u'windSpeed': 3.79, u'cloudCover': 0.01, u'time': 1448413200, u'windBearing': 229, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 311.76, u'temperature': 34.18, u'icon': u'clear-night', u'dewPoint': 22.2, u'humidity': 0.61, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 29.14, u'pressure': 1031.34, u'windSpeed': 5.6, u'cloudCover': 0, u'time': 1448416800, u'windBearing': 231, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 307.95, u'temperature': 33.82, u'icon': u'clear-night', u'dewPoint': 22.76, u'humidity': 0.63, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 29.12, u'pressure': 1032.05, u'windSpeed': 5.1, u'cloudCover': 0, u'time': 1448420400, u'windBearing': 241, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 304.25, u'temperature': 33.62, u'icon': u'clear-night', u'dewPoint': 23.27, u'humidity': 0.65, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 29.05, u'pressure': 1032.77, u'windSpeed': 4.91, u'cloudCover': 0, u'time': 1448424000, u'windBearing': 255, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 300.71, u'temperature': 33.28, u'icon': u'clear-night', u'dewPoint': 23.72, u'humidity': 0.68, u'visibility': 9.99, u'summary': u'Clear', u'apparentTemperature': 29, u'pressure': 1033.49, u'windSpeed': 4.54, u'cloudCover': 0, u'time': 1448427600, u'windBearing': 271, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 297.63, u'temperature': 32.89, u'icon': u'clear-night', u'dewPoint': 23.73, u'humidity': 0.69, u'visibility': 9.98, u'summary': u'Clear', u'apparentTemperature': 28.75, u'pressure': 1034.18, u'windSpeed': 4.34, u'cloudCover': 0, u'time': 1448431200, u'windBearing': 291, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 295.5, u'temperature': 32.59, u'icon': u'clear-night', u'dewPoint': 24, u'humidity': 0.7, u'visibility': 9.96, u'summary': u'Clear', u'apparentTemperature': 28.56, u'pressure': 1034.8, u'windSpeed': 4.19, u'cloudCover': 0, u'time': 1448434800, u'windBearing': 304, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 293.83, u'temperature': 32.26, u'icon': u'clear-night', u'dewPoint': 23.8, u'humidity': 0.71, u'visibility': 9.71, u'summary': u'Clear', u'apparentTemperature': 28.28, u'pressure': 1035.41, u'windSpeed': 4.09, u'cloudCover': 0, u'time': 1448438400, u'windBearing': 309, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 291.45, u'temperature': 31.93, u'icon': u'clear-night', u'dewPoint': 24.04, u'humidity': 0.72, u'visibility': 9.56, u'summary': u'Clear', u'apparentTemperature': 28.56, u'pressure': 1036.17, u'windSpeed': 3.51, u'cloudCover': 0, u'time': 1448442000, u'windBearing': 315, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 287.45, u'temperature': 31.45, u'icon': u'clear-night', u'dewPoint': 24.02, u'humidity': 0.74, u'visibility': 9.32, u'summary': u'Clear', u'apparentTemperature': 28.09, u'pressure': 1037.19, u'windSpeed': 3.46, u'cloudCover': 0, u'time': 1448445600, u'windBearing': 319, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 282.74, u'temperature': 30.63, u'icon': u'clear-night', u'dewPoint': 23.71, u'humidity': 0.75, u'visibility': 9.09, u'summary': u'Clear', u'apparentTemperature': 27.28, u'pressure': 1038.35, u'windSpeed': 3.35, u'cloudCover': 0, u'time': 1448449200, u'windBearing': 323, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 278.8, u'temperature': 31.34, u'icon': u'clear-day', u'dewPoint': 24.49, u'humidity': 0.75, u'visibility': 8.86, u'summary': u'Clear', u'apparentTemperature': 28.38, u'pressure': 1039.46, u'windSpeed': 3.14, u'cloudCover': 0, u'time': 1448452800, u'windBearing': 330, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 276.16, u'temperature': 33.59, u'icon': u'clear-day', u'dewPoint': 26.11, u'humidity': 0.74, u'visibility': 8.99, u'summary': u'Clear', u'apparentTemperature': 33.59, u'pressure': 1040.55, u'windSpeed': 2.72, u'cloudCover': 0, u'time': 1448456400, u'windBearing': 342, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 274.29, u'temperature': 36.63, u'icon': u'clear-day', u'dewPoint': 27.03, u'humidity': 0.68, u'visibility': 9.63, u'summary': u'Clear', u'apparentTemperature': 36.63, u'pressure': 1041.56, u'windSpeed': 2.26, u'cloudCover': 0, u'time': 1448460000, u'windBearing': 1, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 273.09, u'temperature': 39.28, u'icon': u'clear-day', u'dewPoint': 27.56, u'humidity': 0.62, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 39.28, u'pressure': 1042.26, u'windSpeed': 1.91, u'cloudCover': 0, u'time': 1448463600, u'windBearing': 30, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 272.78, u'temperature': 42.2, u'icon': u'clear-day', u'dewPoint': 28.94, u'humidity': 0.59, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 42.2, u'pressure': 1042.53, u'windSpeed': 2.08, u'cloudCover': 0.03, u'time': 1448467200, u'windBearing': 73, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 273.14, u'temperature': 45.01, u'icon': u'clear-day', u'dewPoint': 30.49, u'humidity': 0.56, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 45.01, u'pressure': 1042.53, u'windSpeed': 2.59, u'cloudCover': 0.07, u'time': 1448470800, u'windBearing': 107, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 273.48, u'temperature': 46.25, u'icon': u'clear-day', u'dewPoint': 32.38, u'humidity': 0.58, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 46.25, u'pressure': 1042.55, u'windSpeed': 2.69, u'cloudCover': 0.13, u'time': 1448474400, u'windBearing': 109, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 273.56, u'temperature': 45.61, u'icon': u'clear-day', u'dewPoint': 33.11, u'humidity': 0.61, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 45.61, u'pressure': 1042.7, u'windSpeed': 2.7, u'cloudCover': 0.2, u'time': 1448478000, u'windBearing': 108, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 273.62, u'temperature': 44.12, u'icon': u'partly-cloudy-day', u'dewPoint': 33.43, u'humidity': 0.66, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 44.12, u'pressure': 1042.88, u'windSpeed': 2.66, u'cloudCover': 0.27, u'time': 1448481600, u'windBearing': 107, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 273.7, u'temperature': 42.8, u'icon': u'partly-cloudy-day', u'dewPoint': 33.67, u'humidity': 0.7, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 42.8, u'pressure': 1043.16, u'windSpeed': 2.83, u'cloudCover': 0.32, u'time': 1448485200, u'windBearing': 112, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 273.87, u'temperature': 41.44, u'icon': u'partly-cloudy-night', u'dewPoint': 33.67, u'humidity': 0.74, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 39.35, u'pressure': 1043.6, u'windSpeed': 3.61, u'cloudCover': 0.33, u'time': 1448488800, u'windBearing': 122, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 274.05, u'temperature': 40.5, u'icon': u'partly-cloudy-night', u'dewPoint': 33.55, u'humidity': 0.76, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 37.32, u'pressure': 1044.12, u'windSpeed': 4.67, u'cloudCover': 0.32, u'time': 1448492400, u'windBearing': 126, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 274, u'temperature': 39.87, u'icon': u'partly-cloudy-night', u'dewPoint': 33.49, u'humidity': 0.78, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 35.73, u'pressure': 1044.59, u'windSpeed': 5.81, u'cloudCover': 0.31, u'time': 1448496000, u'windBearing': 129, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 273.49, u'temperature': 39.63, u'icon': u'partly-cloudy-night', u'dewPoint': 33.49, u'humidity': 0.78, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 35.11, u'pressure': 1045, u'windSpeed': 6.32, u'cloudCover': 0.3, u'time': 1448499600, u'windBearing': 133, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 272.74, u'temperature': 39.62, u'icon': u'partly-cloudy-night', u'dewPoint': 33.51, u'humidity': 0.79, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 34.97, u'pressure': 1045.33, u'windSpeed': 6.53, u'cloudCover': 0.28, u'time': 1448503200, u'windBearing': 138, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 272.13, u'temperature': 39.64, u'icon': u'partly-cloudy-night', u'dewPoint': 33.67, u'humidity': 0.79, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 34.86, u'pressure': 1045.51, u'windSpeed': 6.75, u'cloudCover': 0.27, u'time': 1448506800, u'windBearing': 141, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 271.79, u'temperature': 39.57, u'icon': u'partly-cloudy-night', u'dewPoint': 33.98, u'humidity': 0.8, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 34.63, u'pressure': 1045.53, u'windSpeed': 7, u'cloudCover': 0.27, u'time': 1448510400, u'windBearing': 141, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 271.57, u'temperature': 39.41, u'icon': u'partly-cloudy-night', u'dewPoint': 34.31, u'humidity': 0.82, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 34.33, u'pressure': 1045.42, u'windSpeed': 7.16, u'cloudCover': 0.26, u'time': 1448514000, u'windBearing': 140, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 271.44, u'temperature': 39.14, u'icon': u'partly-cloudy-night', u'dewPoint': 34.52, u'humidity': 0.83, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 33.95, u'pressure': 1045.23, u'windSpeed': 7.26, u'cloudCover': 0.26, u'time': 1448517600, u'windBearing': 138, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 271.37, u'temperature': 38.76, u'icon': u'clear-night', u'dewPoint': 34.59, u'humidity': 0.85, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 33.57, u'pressure': 1044.92, u'windSpeed': 7.12, u'cloudCover': 0.24, u'time': 1448521200, u'windBearing': 139, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 271.37, u'temperature': 38.36, u'icon': u'clear-night', u'dewPoint': 34.62, u'humidity': 0.86, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 33.3, u'pressure': 1044.52, u'windSpeed': 6.79, u'cloudCover': 0.21, u'time': 1448524800, u'windBearing': 142, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 271.42, u'temperature': 38.85, u'icon': u'clear-night', u'dewPoint': 35.42, u'humidity': 0.87, u'visibility': 10, u'summary': u'Clear', u'apparentTemperature': 34.03, u'pressure': 1044.22, u'windSpeed': 6.54, u'cloudCover': 0.2, u'time': 1448528400, u'windBearing': 144, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 271.39, u'temperature': 39.46, u'icon': u'clear-night', u'dewPoint': 36.35, u'humidity': 0.88, u'visibility': 9.77, u'summary': u'Clear', u'apparentTemperature': 34.81, u'pressure': 1044.09, u'windSpeed': 6.46, u'cloudCover': 0.24, u'time': 1448532000, u'windBearing': 142, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 271.4, u'temperature': 40.13, u'icon': u'partly-cloudy-night', u'dewPoint': 37.25, u'humidity': 0.89, u'visibility': 9.46, u'summary': u'Partly Cloudy', u'apparentTemperature': 35.47, u'pressure': 1044.07, u'windSpeed': 6.71, u'cloudCover': 0.31, u'time': 1448535600, u'windBearing': 138, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 271.74, u'temperature': 41.28, u'icon': u'partly-cloudy-day', u'dewPoint': 38.24, u'humidity': 0.89, u'visibility': 9.31, u'summary': u'Partly Cloudy', u'apparentTemperature': 36.59, u'pressure': 1044.07, u'windSpeed': 7.17, u'cloudCover': 0.37, u'time': 1448539200, u'windBearing': 136, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 272.67, u'temperature': 43.54, u'icon': u'partly-cloudy-day', u'dewPoint': 39.63, u'humidity': 0.86, u'visibility': 9.46, u'summary': u'Partly Cloudy', u'apparentTemperature': 38.92, u'pressure': 1044.12, u'windSpeed': 7.95, u'cloudCover': 0.43, u'time': 1448542800, u'windBearing': 137, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 273.94, u'temperature': 46.73, u'icon': u'partly-cloudy-day', u'dewPoint': 41.46, u'humidity': 0.82, u'visibility': 9.77, u'summary': u'Partly Cloudy', u'apparentTemperature': 42.31, u'pressure': 1044.15, u'windSpeed': 9.13, u'cloudCover': 0.48, u'time': 1448546400, u'windBearing': 139, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 275.04, u'temperature': 49.44, u'icon': u'partly-cloudy-day', u'dewPoint': 42.93, u'humidity': 0.78, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 45.37, u'pressure': 1043.94, u'windSpeed': 9.91, u'cloudCover': 0.51, u'time': 1448550000, u'windBearing': 142, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 275.85, u'temperature': 51.95, u'icon': u'partly-cloudy-day', u'dewPoint': 44.43, u'humidity': 0.75, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 51.95, u'pressure': 1043.36, u'windSpeed': 10.2, u'cloudCover': 0.51, u'time': 1448553600, u'windBearing': 146, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 276.5, u'temperature': 54.34, u'icon': u'partly-cloudy-day', u'dewPoint': 46, u'humidity': 0.73, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 54.34, u'pressure': 1042.57, u'windSpeed': 10.29, u'cloudCover': 0.48, u'time': 1448557200, u'windBearing': 152, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 276.93, u'temperature': 56.11, u'icon': u'partly-cloudy-day', u'dewPoint': 47.53, u'humidity': 0.73, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 56.11, u'pressure': 1041.81, u'windSpeed': 10.22, u'cloudCover': 0.47, u'time': 1448560800, u'windBearing': 156, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 277.02, u'temperature': 56.76, u'icon': u'partly-cloudy-day', u'dewPoint': 48.85, u'humidity': 0.75, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 56.76, u'pressure': 1041.17, u'windSpeed': 9.83, u'cloudCover': 0.49, u'time': 1448564400, u'windBearing': 157, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 276.89, u'temperature': 55.83, u'icon': u'partly-cloudy-day', u'dewPoint': 49.2, u'humidity': 0.78, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 55.83, u'pressure': 1040.58, u'windSpeed': 9.1, u'cloudCover': 0.53, u'time': 1448568000, u'windBearing': 157, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 276.82, u'temperature': 54.57, u'icon': u'partly-cloudy-day', u'dewPoint': 49.19, u'humidity': 0.82, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 54.57, u'pressure': 1040.14, u'windSpeed': 8.6, u'cloudCover': 0.56, u'time': 1448571600, u'windBearing': 156, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 276.92, u'temperature': 53.16, u'icon': u'partly-cloudy-night', u'dewPoint': 48.93, u'humidity': 0.86, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 53.16, u'pressure': 1039.97, u'windSpeed': 8.47, u'cloudCover': 0.56, u'time': 1448575200, u'windBearing': 154, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 277.08, u'temperature': 51.69, u'icon': u'partly-cloudy-night', u'dewPoint': 48.56, u'humidity': 0.89, u'visibility': 10, u'summary': u'Partly Cloudy', u'apparentTemperature': 51.69, u'pressure': 1039.95, u'windSpeed': 8.49, u'cloudCover': 0.56, u'time': 1448578800, u'windBearing': 153, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 277.19, u'temperature': 50.63, u'icon': u'partly-cloudy-night', u'dewPoint': 48.31, u'humidity': 0.92, u'visibility': 9.95, u'summary': u'Partly Cloudy', u'apparentTemperature': 50.63, u'pressure': 1039.84, u'windSpeed': 8.53, u'cloudCover': 0.55, u'time': 1448582400, u'windBearing': 152, u'precipIntensity': 0, u'precipProbability': 0}, {u'ozone': 277.35, u'temperature': 50.2, u'icon': u'partly-cloudy-night', u'dewPoint': 48.27, u'humidity': 0.93, u'visibility': 8.83, u'summary': u'Partly Cloudy', u'apparentTemperature': 50.2, u'pressure': 1039.59, u'windSpeed': 8.5, u'cloudCover': 0.53, u'time': 1448586000, u'windBearing': 155, u'precipIntensity': 0, u'precipProbability': 0}], u'summary': u'Partly cloudy starting tomorrow afternoon.'}, u'currently': {u'ozone': 315.66, u'temperature': 35.85, u'dewPoint': 20.14, u'nearestStormDistance': 36, u'cloudCover': 0.01, u'humidity': 0.52, u'nearestStormBearing': 153, u'summary': u'Clear', u'apparentTemperature': 32.7, u'pressure': 1030.63, u'windSpeed': 3.83, u'precipProbability': 0, u'visibility': 10, u'time': 1448413276, u'windBearing': 229, u'precipIntensity': 0, u'icon': u'clear-night'}, u'longitude': -71.083544, u'flags': {u'lamp-stations': [u'KASH', u'KBED', u'KBOS', u'KBVY', u'KFIT', u'KLWM', u'KMQE', u'KOWD', u'KPYM', u'KSFZ', u'KTAN'], u'sources': [u'nwspa', u'isd', u'nearest-precip', u'fnmoc', u'sref', u'rtma', u'rap', u'nam', u'cmc', u'gfs', u'madis', u'lamp', u'darksky'], u'units': u'us', u'madis-stations': [u'A1261', u'AN287', u'AV085', u'BHBM3', u'C0210', u'C6612', u'D3706', u'D7355', u'D8100', u'E1024', u'E3565', u'E4331', u'E5351', u'E5650', u'E6480', u'KBOS'], u'darksky-stations': [u'KBOX'], u'isd-stations': [u'725090-14739', u'744907-14753', u'994971-99999', u'999999-14789', u'999999-94701']}, u'daily': {u'icon': u'rain', u'data': [{u'apparentTemperatureMinTime': 1448352000, u'cloudCover': 0.01, u'temperatureMin': 27.22, u'summary': u'Clear throughout the day.', u'dewPoint': 17.9, u'apparentTemperatureMax': 41.37, u'temperatureMax': 43.5, u'temperatureMaxTime': 1448391600, u'windBearing': 256, u'moonPhase': 0.46, u'visibility': 10, u'sunsetTime': 1448399862, u'pressure': 1026.62, u'precipProbability': 0, u'apparentTemperatureMin': 22.58, u'precipIntensityMax': 0, u'icon': u'clear-day', u'apparentTemperatureMaxTime': 1448391600, u'humidity': 0.51, u'ozone': 323.06, u'windSpeed': 4.32, u'time': 1448341200, u'precipIntensity': 0, u'sunriseTime': 1448365633, u'temperatureMinTime': 1448366400}, {u'apparentTemperatureMinTime': 1448449200, u'cloudCover': 0.13, u'temperatureMin': 30.63, u'summary': u'Partly cloudy starting in the afternoon.', u'dewPoint': 29.15, u'apparentTemperatureMax': 46.25, u'temperatureMax': 46.25, u'temperatureMaxTime': 1448474400, u'windBearing': 112, u'moonPhase': 0.49, u'visibility': 9.8, u'sunsetTime': 1448486227, u'pressure': 1040.98, u'precipProbability': 0, u'apparentTemperatureMin': 27.28, u'precipIntensityMax': 0, u'icon': u'partly-cloudy-night', u'apparentTemperatureMaxTime': 1448474400, u'humidity': 0.7, u'ozone': 279.33, u'windSpeed': 0.91, u'time': 1448427600, u'precipIntensity': 0, u'sunriseTime': 1448452103, u'temperatureMinTime': 1448449200}, {u'apparentTemperatureMinTime': 1448524800, u'cloudCover': 0.43, u'temperatureMin': 38.36, u'summary': u'Foggy overnight.', u'dewPoint': 43.07, u'apparentTemperatureMax': 56.76, u'temperatureMax': 56.76, u'temperatureMaxTime': 1448564400, u'windBearing': 149, u'moonPhase': 0.53, u'visibility': 9.33, u'sunsetTime': 1448572595, u'pressure': 1042.26, u'precipProbability': 0, u'apparentTemperatureMin': 33.3, u'precipIntensityMax': 0, u'icon': u'fog', u'apparentTemperatureMaxTime': 1448564400, u'humidity': 0.85, u'ozone': 274.69, u'windSpeed': 8.23, u'time': 1448514000, u'precipIntensity': 0, u'sunriseTime': 1448538573, u'temperatureMinTime': 1448524800}, {u'apparentTemperatureMinTime': 1448614800, u'precipType': u'rain', u'cloudCover': 0.84, u'precipIntensityMaxTime': 1448683200, u'temperatureMin': 48.37, u'summary': u'Drizzle overnight.', u'dewPoint': 50.46, u'apparentTemperatureMax': 59.25, u'temperatureMax': 59.25, u'temperatureMaxTime': 1448650800, u'windBearing': 192, u'moonPhase': 0.57, u'visibility': 5.43, u'sunsetTime': 1448658966, u'pressure': 1029.44, u'precipProbability': 0.02, u'apparentTemperatureMin': 44.89, u'precipIntensityMax': 0.0013, u'icon': u'rain', u'apparentTemperatureMaxTime': 1448650800, u'humidity': 0.9, u'ozone': 273.74, u'windSpeed': 9.09, u'time': 1448600400, u'precipIntensity': 0.0003, u'sunriseTime': 1448625041, u'temperatureMinTime': 1448614800}, {u'apparentTemperatureMinTime': 1448769600, u'precipType': u'rain', u'cloudCover': 0.44, u'precipIntensityMaxTime': 1448701200, u'temperatureMin': 37.12, u'summary': u'Drizzle in the morning.', u'dewPoint': 34.2, u'apparentTemperatureMax': 54.73, u'temperatureMax': 54.73, u'temperatureMaxTime': 1448686800, u'windBearing': 318, u'moonPhase': 0.6, u'sunsetTime': 1448745338, u'pressure': 1026.87, u'precipProbability': 0.48, u'apparentTemperatureMin': 34.03, u'precipIntensityMax': 0.0086, u'icon': u'rain', u'apparentTemperatureMaxTime': 1448686800, u'humidity': 0.71, u'ozone': 297.61, u'windSpeed': 2.66, u'time': 1448686800, u'precipIntensity': 0.003, u'sunriseTime': 1448711509, u'temperatureMinTime': 1448769600}, {u'apparentTemperatureMinTime': 1448794800, u'precipType': u'rain', u'cloudCover': 0.51, u'precipIntensityMaxTime': 1448802000, u'temperatureMin': 32.72, u'summary': u'Mostly cloudy throughout the day.', u'dewPoint': 27.3, u'apparentTemperatureMax': 45.59, u'temperatureMax': 49.17, u'temperatureMaxTime': 1448820000, u'windBearing': 245, u'moonPhase': 0.63, u'sunsetTime': 1448831712, u'pressure': 1025.04, u'precipProbability': 0.03, u'apparentTemperatureMin': 27.68, u'precipIntensityMax': 0.0014, u'icon': u'partly-cloudy-night', u'apparentTemperatureMaxTime': 1448820000, u'humidity': 0.61, u'ozone': 275.29, u'windSpeed': 6, u'time': 1448773200, u'precipIntensity': 0.0009, u'sunriseTime': 1448797976, u'temperatureMinTime': 1448794800}, {u'apparentTemperatureMinTime': 1448884800, u'cloudCover': 0.09, u'temperatureMin': 29.35, u'summary': u'Clear throughout the day.', u'dewPoint': 26, u'apparentTemperatureMax': 39.15, u'temperatureMax': 42.94, u'temperatureMaxTime': 1448906400, u'windBearing': 1, u'moonPhase': 0.67, u'sunsetTime': 1448918089, u'pressure': 1029.86, u'precipProbability': 0, u'apparentTemperatureMin': 23.49, u'precipIntensityMax': 0, u'icon': u'clear-day', u'apparentTemperatureMaxTime': 1448906400, u'humidity': 0.67, u'ozone': 284.95, u'windSpeed': 4.26, u'time': 1448859600, u'precipIntensity': 0, u'sunriseTime': 1448884442, u'temperatureMinTime': 1448884800}, {u'apparentTemperatureMinTime': 1448967600, u'precipType': u'rain', u'cloudCover': 0.74, u'precipIntensityMaxTime': 1449028800, u'temperatureMin': 27.71, u'summary': u'Light rain starting in the evening.', u'dewPoint': 34.87, u'apparentTemperatureMax': 46.18, u'temperatureMax': 49.82, u'temperatureMaxTime': 1449028800, u'windBearing': 161, u'moonPhase': 0.7, u'sunsetTime': 1449004469, u'pressure': 1028.29, u'precipProbability': 0.46, u'apparentTemperatureMin': 27.71, u'precipIntensityMax': 0.0084, u'icon': u'rain', u'apparentTemperatureMaxTime': 1449028800, u'humidity': 0.83, u'ozone': 264.34, u'windSpeed': 4, u'time': 1448946000, u'precipIntensity': 0.0014, u'sunriseTime': 1448970906, u'temperatureMinTime': 1448967600}], u'summary': u'Drizzle on Saturday and Tuesday, with temperatures peaking at 59\xb0F on Friday.'}, u'offset': -5, u'latitude': 42.361369, u'timezone': u'America/New_York', u'minutely': {u'icon': u'clear-night', u'data': [{u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413260}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413320}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413380}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413440}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413500}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413560}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413620}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413680}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413740}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413800}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413860}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413920}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448413980}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414040}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414100}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414160}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414220}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414280}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414340}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414400}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414460}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414520}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414580}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414640}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414700}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414760}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414820}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414880}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448414940}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415000}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415060}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415120}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415180}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415240}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415300}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415360}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415420}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415480}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415540}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415600}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415660}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415720}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415780}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415840}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415900}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448415960}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416020}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416080}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416140}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416200}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416260}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416320}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416380}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416440}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416500}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416560}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416620}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416680}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416740}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416800}, {u'precipIntensity': 0, u'precipProbability': 0, u'time': 1448416860}], u'summary': u'Clear for the hour.'}}  #noqa
    assert format_weather(api_input) == (
        u'Currently: rain - Drizzle on Saturday and Tuesday, with temperatures peaking at 59Â°F on Friday.'
    )
